<!DOCTYPE html>
<html>
<title>Meowton</title>

<head>
    <!-- <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
    <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script> -->
</head>
  <head>
    <script type="text/javascript">
    //call a python function via our simple rpc interface




      function s(pars)
      {
        var req = new XMLHttpRequest();

        // oReq.addEventListener("progress", updateProgress);
        req.addEventListener("load", function (event) {
            if (req.status == 200) {
                console.debug("rpc result 200", req);
            }
            else {
                console.error("rpc result NON 200", req);

            }

        });

        req.addEventListener("error", function (event) {
            console.error("rpc error", req)
        });

        // oReq.addEventListener("abort", transferCanceled);

        req.open('POST', "/send");
        req.send(JSON.stringify(pars));
        return (req);

      }

      function add_event( data )
      {
         var li = document.createElement( "li" );
         li.appendChild( document.createTextNode( "> " + data ) );

         var ul = document.getElementById( "events" );
         ul.appendChild( li );
      }

	  if ( !!window.EventSource )
	  {
	     var source = new EventSource( "/events" );

         source.addEventListener( "message", function( evt )
         {
         	add_event( evt.data );
         }, false );

		 source.addEventListener( "open", function( evt )
		 {
		    add_event( "EventSource open." );
		 }, false );

         source.addEventListener( 'error', function( evt )
         {
            if ( evt.readyState == EventSource.CLOSED )
            {
               add_event( "EventSource closed." );
            }
         }, false );
	  }
	  else
	  {
	    alert( "Events NOT supported by your Browser!" );
	  }
    </script>
  </head>
  <body>
  	<h1>Incoming Events</h1>
  	<ul id="events">
  	</ul>
  </body>
</html>